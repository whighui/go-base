

# golang





# docker 

# docker启动MySQL
docker pull mysql/mysql-server  拉去最新mysql-server适配mac m1版本
1. 启动 docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql/mysql-server
2. -v /Users/byte/Desktop/docker/mysql/data:/var/lib/mysql  -v /Users/byte/Desktop/docker/mysql/log:/logs   -v /Users/byte/Desktop/docker/mysql/conf:/etc/mysql/conf.d
3. 上述 -v 是Mysql数据映射到主机目录上 可以这么理解呗
2. 进入到mysql容器内部 docker exec -it mysql bash
   https://www.jianshu.com/p/eb3d9129d880  参考这个博客 基本上就是没有错误

# docker启动redis
1. 启动redis: docker run -p 6379:6379 --name redis -v /Users/bytedance/Desktop/whig/data/redis/data:/data -v /Users/bytedance/Desktop/whig/data/redis/redis.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf
2. 参考博客 https://blog.csdn.net/u013868195/article/details/119778589



# -------------------==项目经历==------------------------



# 互娱研发-抖音 抖音全链路资产发现

# 项目概述

# 项目难点
1. 延迟问题：理论上十点采集的数据，11点应该识别出来，避免敏感字段透出太长时间。及时发现风险进行治理
   a. 前缀树优化 （children节点个数大于50的话，开启协程进行扫描 删除长时间未访问的数据、 前缀树进行压缩）
   b. 拉取overpass信息是通过中台服务，服务启动的时是缓存在本地。 --->缓存在中心化存储软件redis当中。
      同一批流量过来，如若版本号不一致 分布式锁更新缓存 其他流量进行等待  每个进程都需要进行拉取一遍 消耗太大
   c. bmq消费堆积问题。流量在百万QPS左右，这种mq消费堆积 一个group多个goroutine进行消费 采用ants协程池

# -------------------==面试==--------------------------



# bongcong 面试


华为：

1. golang数组作为参数，会影响外部吗
2. 进程、线程、协程之间通信方式
3. context 和 channel 关系和衍生
4. 子协程panic会影响主协程吗
5. http请求参数和响应参数、熟知状态码

算法：
1. 最大回文字符串

   知乎：
1. 令牌桶实现方式
2. redis_scene aof rdb实现方式
3. redis_scene zset底层数据结构 跳表时间复杂度

场景提：设计一个高并发的积分排行榜

算法： 回文链表

知乎二面：

1. 项目背景：链路层获取或者存储层获取 收集起来
   技术选型：bmq mysql redis abase 协程池、前缀树、令牌桶、通信协议、缓存结构（拉取overpass）
   redis、mysql 双写一致性  redis底层数据结构  AOF追加写机制(每写一条命令进行追加写到AOF文件当中) RDB快照机制(看频率 容易丢数据)
   redis分布式锁怎么实现的
   前缀树
   协程池
   分布式令牌桶  单机令牌桶



角色：维护注册任务、采集服务优化、要求实时性、10点采集数据11点透传到下游
不足：项目比较耦合、
1. CPU有尖刺状态 什么情况导致的 如何优化 如何进行解决 优化数据结构  LRU长度缩短点 利用多级缓存

场景提：
1. 并发高系统 go语言实现  缓存lru实现（实现上正常）  cpu每隔几分钟会有一个尖刺 分析原因  GC原因 分析原因
2. 设计签到系统 千万级QPS 同时运营需求 统计连续多少天签到 连续1、3、5签到 连续一个月签到 还需要历史签到能力做统计分析 半年内每个周五签到情况 redis只存当天的数据 -> mysql -> hive
   设计接口 设计存储 整条链路是怎么样
   千万级QPS数据库压力大了，怎么优化 setbit sing_status zhangsan+23829 1
   暴露签到接口（用户只关心今天已经签到） redis分布式存储 怎么实现的分布式存储（一致性hash）打到异步mq进行mysql存储
3. 高并发排行榜  zset做排序 redis做分布式存储 在最后做归并排序 每日排行、周排行、月排行、历史排行  用户王者荣耀、好友排行、段位排行
4.
-----------------------------------------------------------------------------------------------------------------------
八股：
最多redis zset底层 redis持久化存储（redis怎么保证数据不丢失、写数据处理命令）
网络还行
操作系统也还行  进程、协程、线程
Mysql基本也不问八股

讲一下MVVC 怎么用
每条记录都有一个trx_id
事物开启生成快照 min_txr_id  活跃事物ID  max_trx_id+1（当前活跃事物找到最大值+1）
当前事物要查询记录  在这个事物里查询这条记录的事物ID < min_txr_id 这条记录是可见的
ID>max_trx_id 往前追溯 找到符合规则的记录 事物可见的记录(1.小于trx_id  2.在min和Max区间范围之内，但是不在活跃事物ID当中 存在有的事物执行完了)
更新   当前读
查询   select for update

操作系统：分配内存 golang、c++、c  malloc分配内存  熟悉内存组成
使用两种方式：阈值
大于128K 在mmap区进行分配内存 mmap文件映射区 (free函数之后 mmap可以主动释放、 释放之后交给内核)
小于128K brk函数在堆上进行分配  堆上不能主动释放（回收机制：堆上高地址内存没被释放、地址值内存地址也没被释放（不能给操作系统回收掉）  导致堆上有内存碎片 在申请可以直接使用 可以重复利用 ）

网络:
https:加密过程
状态码：
websocket tcp



# 拼多多 一面 23年9月3号

1. 项目介绍 团队职责 
2. 项目中认为什么地方困难点

MySQL：
1. 聚族索引和非聚族索引区别
2. MySQL select update两个操作实现要求操作同一条记录   用乐观锁和悲观锁两种方式进行实现
3. select ... for update 如果记录不存在是否进行上锁  
   要了解上的什么锁 要不还是不能畅谈

Kafka:
1. 如何保证消息投递的可靠性  ack+retry
2. broken主节点宕机了 怎么办

Redis:
1. 数据结构 balabala 沉默了五秒钟
2. 疯狂输出sds底层数据结构 length长度 3bit 1byte 2byte 4byte 8byte字节的数据结构 并讲述packet禁止内存对齐 面试官不在在redis上停留 还的是疯狂输出比较得劲

java：
1. java和golang区别
2. spring aop 解释一下，框架是怎么实现的 (参考gorm钩子函数)

other:
1. 乐观锁和悲观锁区别 

算法：
1. 两个链表，判断相同元素 （这里边应该是lc相交链表 但是好像还是不一样 题目没有问清楚 ） 解题思路：遍历+hash 询问是否压缩空间
2. 二叉树，根节点上的路径和  lc-路径总和II的一个变种题


# 拼多多 二面 23年9月10号
1. 项目介绍 将近半个小时 面试官不知道难点在哪 感觉没什么难点

算法
1. 最长递增子序列个数  【1，2，3，5，4，9】 【1，1，1，1，1】  dp动态数组没A出来 将近浪费半个点
2. 个人情况的先关介绍

职业发展
1. 为什么考虑换工作  目前工作没有挑战性 被问到什么工作具有挑战性 
2. 希望C端还是平台方向发展  本人还是更倾向于业务  业务创造价值被  更希望希望被广泛使用 是自己价值感和认同感得以提升
3. 上一次绩效
4. 考研成绩
5. 本科成绩





# 快手一面 23年9月12日
1. 项目介绍

mysql
1. select 一条语句发生了什么 认证->连接->缓存->词法分析->语法分析->存储引擎层
2. binlog日志了解吗 逻辑备份 主要用于数据库主从同步与增量复制
3. binlog日志  update100条语句 binlog日志写一条 还是写100条 取决于数据库复制的模式
              【1.row_level 每行记录修改都会被记录下来，优点数据一致性 缺点：日志量比较大 主从同步 从消费binlog日志可能导致延迟 】
              【2.statement_level】记录更改记录的SQL语句，而不是每条记录。但是缺点：主从同步缺少上下文信息 使用特定功能函数例如last_insert_id 会导致歧义
              【3.mix_level】集合1 2 两种方式

4. undolog日志 作用 
5. 更新一条语句都有哪些日志会更新  undolog binlog redolog 

redis
1. 数据结构 
2. 字符串  sds 底层动态数组 TLV组层 不同长度的字符串使用不同的数据结构
3. 字符串  bitmap底层
4. 字符串  set key value=数字的话 使用long类型来存储
5. list   底层ziplist 紧凑的数组 zlbytes  zllen  zltail 
6. set    底层hash
7. zset   跳表+hash
8. .....
9. redis 怎么定义大key  相对而已
10. redis 什么算作热点key 28原理 80%流量查询热点key 

kafka
1. kafka架构
2. 幂等性原理 
3. 如何保证不重复消费  假如正在消费，但是突然节点宕机，消费成功但是offset没有+1 在该场景下如何保证不重复消费（生产者不生产重复消息，消费者在业务逻辑上做消费处理，可以加一个唯一标识 例如产品ID 入库判断）
4. 如何保证消息投递的可靠性

算法：
1. 合并两个有序链表  循环写出来 面试官再让用递归来写



# 快手二面 23年9.19号

1. 项目背景  难点  收货
2. 长短链系统设计  高并发、稳定性、扩展性、易用性等几个方面来设计 存储、编码和解码
   1. 商品ID+短链设计  比较菜   没有打好
3. redis集群部署方式  clauster codis 中心化存储  比较菜没答上来

算法

1. 12345输出一万两千三百四十五  文本格式调通了



# 迅雷一面

1. 项目介绍 认为项目成长的地方 以及 项目中难点
2. 为什么跳糟

golang
1. 并发常见的数据结构
2. context中什么功能最重要
3. mutex和atomic原子包实现并发安全区别
4. golang gc触发时刻 gc调度时刻
5. map 什么类型可以当做key  map中struct结构体可以当做key吗（没有回答上来，主要是hash函数由谁来实现的）
6. map 为什么并发不安全  不安全在哪
7. map rehash扩容机制 （分读请求和写请求）写请求写新的 读请求如果命中顺带写 读请求两个都命中那么以新的为准（因为新的可能写）
8. mutex实现原理 （简单说了一下就是用数组来实现，通过不同的标志位来判断是否进行上锁，标志位的更改利用原子能力来实现，并且有进行过优化）


mysql
1. mysql主动使用过事物没
2. mysql索引使用Innodb 建立索引一些注意事项
3. mysql 线上发生过死锁没
4. mysql 为什么不建议varchar较长类型建立索引 （更新、删除、查找耗时除外） 建立二级索引B+树 每个节点占据内存空间较大，如果超出16KB会进行分页，IO查询比较高
5. 联合索引 index(A,B,C) 
6. mysql死锁场景发生过没

redis
1. 常见数据结构
2. 说了下底层实现
3. 还有什么数据结构

算法：
给定二叉树任意节点， 求二叉树中序遍历的下一个节点 （没有做上来 二叉树这里边还是比较懵啊）主要是算法没回答上来

反问
1. 技术leader当组长 而不是管理型leader当组长
2. 项目变换频繁吗 或者OKR制定中途是否更改呢 
  个人感觉 迅雷面试官给人感觉不错 整体上引导面试者来说

